10 ISTT
90 DIM SN(14):KEY OFF
100 CLS:SCREEN 0
110 PRINT"ENTER AN EVEN NO. OF CYCLES (2 TO 14)"
120 INPUT"          OR ENTER A ZERO TO QUIT: ";NC
130 IF NC = 0 THEN KEY ON:END
140 IF NC MOD 2 = 1 OR NC < 2 OR NC > 14 THEN 100
150 L=128:FOR C=2 TO NC STEP 2:L=L/2:NEXT
160 X=192:Y=133:CLS:SCREEN 2:PSET (X,Y),1
170 FOR C=0 TO NC:SN(C)=0:NEXT
180 D=0:FOR C=1 TO NC:IF SN(C-1)=SN(C) THEN D=D-1:GOTO 200
190 D=D+1
200 IF D=-1 THEN D=7
210 IF D=8 THEN D=0
220 NEXT
230 IF D=0 THEN X=X+L+L:GOTO 270
240 IF D=2 THEN Y=Y+L:GOTO 270
250 IF D=4 THEN X=X-L-L:GOTO 270
260 Y=Y-L
270 LINE -(X,Y),1:SN(NC)=SN(NC)+1
280 FOR C=NC TO 1 STEP -1:IF SN(C)<>2 THEN 300
290 SN(C)=0:SN(C-1)=SN(C-1)+1:NEXT
300 IF SN(0)=0 THEN 180
310 IF INKEY$="" THEN 310
320 GOTO 100
